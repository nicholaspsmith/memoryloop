# Data Model Changes: Remove AI Branding

**Feature**: 015-remove-ai-branding
**Date**: 2025-12-29

## Overview

This feature primarily removes data rather than adding it. The changes focus on eliminating AI-provider-specific information from the data layer.

## Database Changes

### No Schema Changes Required

The current database schema does not store user API keys or AI provider preferences. The `api_keys` table was removed in a previous migration (0006_remove_api_keys.sql).

**Verification**: No `api_keys` table exists in current schema.

### Field Considerations

#### messages.aiProvider field

**Current state**: Messages table has an `aiProvider` field that stores 'claude' or 'ollama'.

**Decision**: Keep the field but always set to a neutral value or null.

**Rationale**:

- Removing the column would require a migration
- The field is not exposed to users
- Can be used internally for debugging if needed
- Setting to null or 'default' maintains compatibility

**Implementation**:

```typescript
// Before
aiProvider: 'claude' | 'ollama'

// After
aiProvider: null // Or remove the field from inserts entirely
```

## Environment Configuration

### Variables to Remove

```env
# DELETE these from .env.example and production
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=llama3.2
```

### Variables to Keep/Add

```env
# REQUIRED - Content generation API key
ANTHROPIC_API_KEY=sk-ant-api03-...
```

## LanceDB Vector Storage

### Current State

LanceDB stores embeddings generated by Ollama for:

- Flashcards (for similarity search)
- Messages (for context retrieval)

### After Changes

With Ollama removed, embeddings will not be generated:

- New records will have empty/null embedding vectors
- Existing embeddings remain (no migration needed)
- Similarity search will return empty results for new content
- This is acceptable degradation per research.md decision

### Future Consideration

When a new embedding provider is added:

- Backfill embeddings for existing records
- Update `lib/embeddings/` with new provider
- No schema changes needed (same vector dimensions)

## No New Entities

This feature does not introduce new data entities. It simplifies by removing:

- Ollama-related configuration
- User-facing API key management
- Provider selection state
